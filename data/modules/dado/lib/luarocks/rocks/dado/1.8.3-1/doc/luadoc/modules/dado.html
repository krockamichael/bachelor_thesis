<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>ldoc</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><strong>dado</strong></li>
  <li><a href="../modules/dado.object.html">dado.object</a></li>
  <li><a href="../modules/dado.sql.html">dado.sql</a></li>
  <li><a href="../modules/table.extra.html">table.extra</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>dado</code></h1>
<p>Dado is a set of facilities implemented over LuaSQL connection objects.</p>
<p>
 The module's goal is to simplify the most used database operations.
</p>
    <h3>Info:</h3>
    <ul>
        <li><strong>Release</strong>: $Id: dado.lua,v 1.26 2017/04/05 19:14:07 tomas Exp $</li>
    </ul>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#assertexec">assertexec (self, stmt)</a></td>
	<td class="summary">Executes a SQL statement raising an error if something goes wrong.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#commit">commit (self)</a></td>
	<td class="summary">Commits the current transaction.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#rollback">rollback (self)</a></td>
	<td class="summary">Rolls back the current transaction.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#setautocommit">setautocommit (self, bool)</a></td>
	<td class="summary">Turn autocommit mode on or off.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#nextval">nextval (self, seq, field)</a></td>
	<td class="summary">Obtains next value from a sequence.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#delete">delete (self, tabname, cond)</a></td>
	<td class="summary">Deletes a row.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#insert">insert (self, tabname, contents)</a></td>
	<td class="summary">Inserts a new row.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#update">update (self, tabname, contents, cond)</a></td>
	<td class="summary">Updates existing rows.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#select">select (self, columns, tabname, cond, extra, mode)</a></td>
	<td class="summary">Retrieves rows.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#selectall">selectall (self, columns, tabname, cond, extra, mode)</a></td>
	<td class="summary">Retrieves all rows.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#wrap_connection">wrap_connection (conn, key)</a></td>
	<td class="summary">Wraps a database connection into a connection object.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#connect">connect (dbname, dbuser, dbpass, driver)</a></td>
	<td class="summary">Tries to use a connection in the cache or opens a new one.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#close">close (self)</a></td>
	<td class="summary">Closes the connection and invalidates the object.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "assertexec"></a>
    <strong>assertexec (self, stmt)</strong>
    </dt>
    <dd>
    Executes a SQL statement raising an error if something goes wrong.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">stmt</span>
         String with SQL statement.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

         Cursor or number of rows affected by the command
	(it never returns nil,errmsg).

    </ol>




</dd>
    <dt>
    <a name = "commit"></a>
    <strong>commit (self)</strong>
    </dt>
    <dd>
    Commits the current transaction.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "rollback"></a>
    <strong>rollback (self)</strong>
    </dt>
    <dd>
    Rolls back the current transaction.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
    </ul>





</dd>
    <dt>
    <a name = "setautocommit"></a>
    <strong>setautocommit (self, bool)</strong>
    </dt>
    <dd>
    Turn autocommit mode on or off.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">bool</span>
         Boolean indicating to turn autocommit on (true) or off (false).
        </li>
    </ul>





</dd>
    <dt>
    <a name = "nextval"></a>
    <strong>nextval (self, seq, field)</strong>
    </dt>
    <dd>
    Obtains next value from a sequence.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">seq</span>
         String with sequence name (complete name or just the name of the
	table).
        </li>
        <li><span class="parameter">field</span>
         String (optional) with the name of the primary key associated
	with the sequence.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        String with next sequence value.
    </ol>




</dd>
    <dt>
    <a name = "delete"></a>
    <strong>delete (self, tabname, cond)</strong>
    </dt>
    <dd>
    Deletes a row.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">tabname</span>
         String with table name.
        </li>
        <li><span class="parameter">cond</span>
         String with where-clause (and following SQL text).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Number of rows affected.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/dado.sql.html#delete">dado.sql.delete</a>
    </ul>


</dd>
    <dt>
    <a name = "insert"></a>
    <strong>insert (self, tabname, contents)</strong>
    </dt>
    <dd>
    Inserts a new row.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">tabname</span>
         String with table name.
        </li>
        <li><span class="parameter">contents</span>
         Table with field-value pairs.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Number of rows affected.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/dado.sql.html#insert">dado.sql.insert</a>
    </ul>


</dd>
    <dt>
    <a name = "update"></a>
    <strong>update (self, tabname, contents, cond)</strong>
    </dt>
    <dd>
    Updates existing rows.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">tabname</span>
         String with table name.
        </li>
        <li><span class="parameter">contents</span>
         Table with field-value pairs.
        </li>
        <li><span class="parameter">cond</span>
         String with where-clause (and following SQL text).
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Number of rows affected.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/dado.sql.html#update">dado.sql.update</a>
    </ul>


</dd>
    <dt>
    <a name = "select"></a>
    <strong>select (self, columns, tabname, cond, extra, mode)</strong>
    </dt>
    <dd>
    Retrieves rows.
 Creates an iterator over the result of a query.
 This iterator could be used in for-loops.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">columns</span>
         String with fields list.
        </li>
        <li><span class="parameter">tabname</span>
         String with table name.
        </li>
        <li><span class="parameter">cond</span>
         String with where-clause (and following SQL text).
        </li>
        <li><span class="parameter">extra</span>
         String with extra SQL text (to be used when there is no
	where-clause).
        </li>
        <li><span class="parameter">mode</span>
         String or Table indicating fetch mode (according to LuaSQL mode
	parameter of fetch method); if it is a table, the result will be stored
	inside it and the actual mode will be 'a'; in both cases, the function
	should return a table with the result set.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>
        <li>
        Iterator over the result set.</li>
        <li>
        Cursor object (to allow explicit closing).</li>
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/dado.sql.html#select">dado.sql.select</a>
    </ul>


</dd>
    <dt>
    <a name = "selectall"></a>
    <strong>selectall (self, columns, tabname, cond, extra, mode)</strong>
    </dt>
    <dd>
    Retrieves all rows.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
        <li><span class="parameter">columns</span>
         String with fields list.
        </li>
        <li><span class="parameter">tabname</span>
         String with table name.
        </li>
        <li><span class="parameter">cond</span>
         String with where-clause (and following SQL text).
        </li>
        <li><span class="parameter">extra</span>
         String with extra SQL text.
        </li>
        <li><span class="parameter">mode</span>
         String indicating fetch mode (default == 'a').
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Table with the entire result set.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../modules/dado.sql.html#select">dado.sql.select</a>
    </ul>


</dd>
    <dt>
    <a name = "wrap_connection"></a>
    <strong>wrap_connection (conn, key)</strong>
    </dt>
    <dd>
    Wraps a database connection into a connection object.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">conn</span>
         Object with LuaSQL database connection.
        </li>
        <li><span class="parameter">key</span>
         String with the key to the database object in the cache.
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Dado Connection.
    </ol>




</dd>
    <dt>
    <a name = "connect"></a>
    <strong>connect (dbname, dbuser, dbpass, driver)</strong>
    </dt>
    <dd>
    Tries to use a connection in the cache or opens a new one.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">dbname</span>
         String with database name.
        </li>
        <li><span class="parameter">dbuser</span>
         String with database username (optional).
        </li>
        <li><span class="parameter">dbpass</span>
         String with database user password (optional).
        </li>
        <li><span class="parameter">driver</span>
         String with LuaSQL's driver (default = "postgres").
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

        Connection.
    </ol>




</dd>
    <dt>
    <a name = "close"></a>
    <strong>close (self)</strong>
    </dt>
    <dd>
    Closes the connection and invalidates the object.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">self</span>
         Dado Object.
        </li>
    </ul>





</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2017-04-05 16:14:10 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
